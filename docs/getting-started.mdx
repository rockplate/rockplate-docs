# Getting Started

## Installation

Installing with `npm` or `yarn`

```
npm install rockplate
yarn add rockplate
```

Installing with `<script>` tag

```html
<script src="https://cdn.jsdelivr.net/npm/rockplate@latest/dist/rockplate.min.js"></script>
```

## Usage

TypeScript/JavaScript

```javascript
import { Rockplate } from 'rockplate';

const template = 'My name is [my name]';
const schema = {
  my: {
    name: 'My Name',
  },
};
const rpl = new Rockplate(template, schema);
const output = rpl.parse({
  // you will get type hints
  // for properties in schema as you type
  my: {
    name: 'Safraz Razik',
  },
});
console.log(output); // My name is Safraz Razik
```

Usage with `<script>` tag:

```javascript
var Rockplate = window.rockplate.Rockplate;

var rpl = new Rockplate(template, schema);

// ...
```

## Usage with an `.rpl` file

NOTE: If you're using Visual Studio Code, install the [Official Extension](https://github.com/rockplate/rockplate-vscode) to get IntelliSense and Linting support for `.rpl` files.

![Rockplate VSCode](https://raw.githubusercontent.com/rockplate/rockplate-vscode/master/images/rockplate-demo.gif)

You can embed schema in an `.rpl` file in json format on top of the file. If you choose to have your schema in an external json file, you should reference that json file from your rpl file by defining a json object on top of the file with only a key named `"schema"` with the json file path relative to the rpl file

`my-schema.json` file

```json
{
  "my": {
    "name": "My Name"
  }
}
```

`my-template.rpl` file

```rockplate
{
    "schema": "./my-schema.json"
}

My name is [my name]
```

Reading files synchronously

```javascript
import { Rockplate } from 'rockplate';
import { readFileSync } from 'fs';
import { resolve, dirname } from 'path';

const getRpl = (templateFile) => {
  const schemaResolver = (schemaUrl) => {
    const filePath = resolve(dirname(templateFile), schemaUrl);
    const fileContent = readFileSync(filePath, 'utf8');
    return JSON.parse(fileContent);
  };

  const template = readFileSync(templateFile, 'utf8');

  return new Rockplate(template, schemaResolver);
};

const rpl = getRpl('/some/dir/my-template.rpl');
const output = rpl.parse({
  // ...
});
```

Reading files asynchronously

```javascript
import { Rockplate } from 'rockplate';
import { readFile } from 'fs';
import { resolve, dirname } from 'path';

const getRpl = (templateFile) => {
  const schemaResolver = (schemaUrl) => {
    const filePath = resolve(dirname(templateFile), schemaUrl);
    return new Promise((resolve, reject) => {
      readFile(filePath, 'utf8', (err, fileContent) => {
        if (err) {
          reject(err);
          return;
        }
        resolve(JSON.parse(fileContent));
      });
    });
  };

  return new Promise((resolve, reject) => {
    readFile(templateFile, 'utf8', (err, template) => {
      if (err) {
        reject('template file could not be read');
        return;
      }
      const rpl = new Rockplate(template, schemaResolver);
      // important! - as schema is resolved asynchronously, you should wait for rpl.build() to resolve
      rpl.build().then(() => {
        resolve(rpl);
      });
    });
  });
};

getRpl('/some/dir/my-template.rpl').then((rpl) => {
  const output = rpl.parse({
    // ...
  });
});
```
